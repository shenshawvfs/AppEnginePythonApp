<!-- Template componet for sub page within home page -->
<div id="sub-panel">

    <form id="sub-submit" name="Create Persona">
        Player Name: <input type="text" name="PlayerName" value={{ player_name }}>
        Persona Name: <input type="text" name="PersonaName" value={{ persona_name }}>
        <input type="button" value="Add"> 
    </form>

</div>


<script type="text/javascript" id="editor_js">

    /*
     *  This singleton object controlls the template code above
     */
	var subPanel = (function() {
	
	    function SubCtrl() {

	        var local = {};
	        var self = this;
	    
	        self.init = function() {
	            
	            $("#sub-submit").on('click', function() {
	                local.savePlayer();
                });
            }; 
	    
            
            local.savePlayer = function() {
	        
    	        // Post request for data to the server (python code)
    	        var instr = $("#sub-submit").serialize()+"&cmd=add_user";
    	        $.post( '/sub', instr)
    	            .then( function( result ) {
    	                
    	                if (result.returnCode === 0) {
    	        
    	                    // screen element update( obj.playerJSON );
    	                    local.render( result );
    	        
    	                } else if (result.returnCode === -1) {
    	        
    	                    window.location = '/';
    	                    return;
    	                }
    	            });
    	    };
	    
            local.render = function( data ) {
	        
    	        $("input[name='PlayerName']").val( data.playerName );
    	        $("input[name='DriverName']").val( data.driverName );
	        };
	    };
	    return new SubCtrl();
	    
	})().init();
    
</script>